---
title: Envoy Filter
description: Customizing Envoy configuration generated by Istio.
location: https://istio.io/docs/reference/config/networking/envoy-filter.html
layout: protoc-gen-docs
generator: protoc-gen-docs
schema: istio.networking.v1alpha3.EnvoyFilter
aliases: [/docs/reference/config/networking/v1alpha3/envoy-filter]
number_of_entries: 18
---
<h2 id="EnvoyFilter">EnvoyFilter</h2>
<section>
<p>EnvoyFilter provides a mechanism to customize the Envoy configuration
generated by Istio Pilot.</p>

<table class="message-fields">
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr id="EnvoyFilter-workload_selector">
<td><code>workloadSelector</code></td>
<td><code><a href="https://istio.io/docs/reference/config/networking/sidecar.html#WorkloadSelector">WorkloadSelector</a></code></td>
<td>
<p>Criteria used to select the specific set of pods/VMs on which
this patch configuration should be applied. If omitted, the set
of patches in this configuration will be applied to all workload
instances in the same namespace.  If omitted, the <code>EnvoyFilter</code>
patches will be applied to all workloads in the same
namespace. If the <code>EnvoyFilter</code> is present in the config root
namespace, it will be applied to all applicable workloads in any
namespace.</p>

</td>
<td>
No
</td>
</tr>
<tr id="EnvoyFilter-config_patches">
<td><code>configPatches</code></td>
<td><code><a href="#EnvoyFilter-EnvoyConfigObjectPatch">EnvoyConfigObjectPatch[]</a></code></td>
<td>
<p>One or more patches with match conditions.</p>

</td>
<td>
Yes
</td>
</tr>
</tbody>
</table>
</section>
<h2 id="EnvoyFilter-ProxyMatch">EnvoyFilter.ProxyMatch</h2>
<section>
<p>One or more properties of the proxy to match on.</p>

<table class="message-fields">
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr id="EnvoyFilter-ProxyMatch-proxy_version">
<td><code>proxyVersion</code></td>
<td><code>string</code></td>
<td>
<p>A regular expression in golang regex format (RE2) that can be
used to select proxies using a specific version of istio
proxy. The Istio version for a given proxy is obtained from the
node metadata field <code>ISTIO_VERSION</code> supplied by the proxy when
connecting to Pilot. This value is embedded as an environment
variable (<code>ISTIO_META_ISTIO_VERSION</code>) in the Istio proxy docker
image. Custom proxy implementations should provide this metadata
variable to take advantage of the Istio version check option.</p>

</td>
<td>
No
</td>
</tr>
<tr id="EnvoyFilter-ProxyMatch-metadata">
<td><code>metadata</code></td>
<td><code>map&lt;string,&nbsp;string&gt;</code></td>
<td>
<p>Match on the node metadata supplied by a proxy when connecting
to Istio Pilot. Note that while Envoy&rsquo;s node metadata is of
type Struct, only string key-value pairs are processed by
Pilot. All keys specified in the metadata must match with exact
values. The match will fail if any of the specified keys are
absent or the values fail to match.</p>

</td>
<td>
No
</td>
</tr>
</tbody>
</table>
</section>
<h2 id="EnvoyFilter-ClusterMatch">EnvoyFilter.ClusterMatch</h2>
<section>
<p>Conditions specified in <code>ClusterMatch</code> must be met for the patch
to be applied to a cluster.</p>

<table class="message-fields">
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr id="EnvoyFilter-ClusterMatch-port_number">
<td><code>portNumber</code></td>
<td><code>uint32</code></td>
<td>
<p>The service port for which this cluster was generated.  If
omitted, applies to clusters for any port.</p>

</td>
<td>
No
</td>
</tr>
<tr id="EnvoyFilter-ClusterMatch-service">
<td><code>service</code></td>
<td><code>string</code></td>
<td>
<p>The fully qualified service name for this cluster. If omitted,
applies to clusters for any service. For services defined
through service entries, the service name is same as the hosts
defined in the service entry.</p>

</td>
<td>
No
</td>
</tr>
<tr id="EnvoyFilter-ClusterMatch-subset">
<td><code>subset</code></td>
<td><code>string</code></td>
<td>
<p>The subset associated with the service. If omitted, applies to
clusters for any subset of a service.</p>

</td>
<td>
No
</td>
</tr>
<tr id="EnvoyFilter-ClusterMatch-name">
<td><code>name</code></td>
<td><code>string</code></td>
<td>
<p>The exact name of the cluster to match. To match a specific
cluster by name, such as the internally generated <code>Passthrough</code>
cluster, leave all fields in clusterMatch empty, except the
name.</p>

</td>
<td>
No
</td>
</tr>
</tbody>
</table>
</section>
<h2 id="EnvoyFilter-RouteConfigurationMatch">EnvoyFilter.RouteConfigurationMatch</h2>
<section>
<p>Conditions specified in RouteConfigurationMatch must be met for
the patch to be applied to a route configuration object or a
specific virtual host within the route configuration.</p>

<table class="message-fields">
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr id="EnvoyFilter-RouteConfigurationMatch-port_number">
<td><code>portNumber</code></td>
<td><code>uint32</code></td>
<td>
<p>The service port number or gateway server port number for which
this route configuration was generated. If omitted, applies to
route configurations for all ports.</p>

</td>
<td>
No
</td>
</tr>
<tr id="EnvoyFilter-RouteConfigurationMatch-port_name">
<td><code>portName</code></td>
<td><code>string</code></td>
<td>
<p>Applicable only for GATEWAY context. The gateway server port
name for which this route configuration was generated.</p>

</td>
<td>
No
</td>
</tr>
<tr id="EnvoyFilter-RouteConfigurationMatch-gateway">
<td><code>gateway</code></td>
<td><code>string</code></td>
<td>
<p>The Istio gateway config&rsquo;s namespace/name for which this route
configuration was generated. Applies only if the context is
GATEWAY. Should be in the namespace/name format. Use this field
in conjunction with the <code>portNumber</code> and <code>portName</code> to accurately
select the Envoy route configuration for a specific HTTPS
server within a gateway config object.</p>

</td>
<td>
No
</td>
</tr>
<tr id="EnvoyFilter-RouteConfigurationMatch-vhost">
<td><code>vhost</code></td>
<td><code><a href="#EnvoyFilter-RouteConfigurationMatch-VirtualHostMatch">VirtualHostMatch</a></code></td>
<td>
<p>Match a specific virtual host in a route configuration and
apply the patch to the virtual host.</p>

</td>
<td>
No
</td>
</tr>
<tr id="EnvoyFilter-RouteConfigurationMatch-name">
<td><code>name</code></td>
<td><code>string</code></td>
<td>
<p>Route configuration name to match on. Can be used to match a
specific route configuration by name, such as the internally
generated <code>http_proxy</code> route configuration for all sidecars.</p>

</td>
<td>
No
</td>
</tr>
</tbody>
</table>
</section>
<h2 id="EnvoyFilter-ListenerMatch">EnvoyFilter.ListenerMatch</h2>
<section>
<p>Conditions specified in a listener match must be met for the
patch to be applied to a specific listener across all filter
chains, or a specific filter chain inside the listener.</p>

<table class="message-fields">
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr id="EnvoyFilter-ListenerMatch-port_number">
<td><code>portNumber</code></td>
<td><code>uint32</code></td>
<td>
<p>The service port/gateway port to which traffic is being
sent/received. If not specified, matches all listeners. Even though
inbound listeners are generated for the instance/pod ports, only
service ports should be used to match listeners.</p>

</td>
<td>
No
</td>
</tr>
<tr id="EnvoyFilter-ListenerMatch-filter_chain">
<td><code>filterChain</code></td>
<td><code><a href="#EnvoyFilter-ListenerMatch-FilterChainMatch">FilterChainMatch</a></code></td>
<td>
<p>Match a specific filter chain in a listener. If specified, the
patch will be applied to the filter chain (and a specific
filter if specified) and not to other filter chains in the
listener.</p>

</td>
<td>
No
</td>
</tr>
<tr id="EnvoyFilter-ListenerMatch-name">
<td><code>name</code></td>
<td><code>string</code></td>
<td>
<p>Match a specific listener by its name. The listeners generated
by Pilot are typically named as IP:Port.</p>

</td>
<td>
No
</td>
</tr>
</tbody>
</table>
</section>
<h2 id="EnvoyFilter-Patch">EnvoyFilter.Patch</h2>
<section>
<p>Patch specifies how the selected object should be modified.</p>

<table class="message-fields">
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr id="EnvoyFilter-Patch-operation">
<td><code>operation</code></td>
<td><code><a href="#EnvoyFilter-Patch-Operation">Operation</a></code></td>
<td>
<p>Determines how the patch should be applied.</p>

</td>
<td>
No
</td>
</tr>
<tr id="EnvoyFilter-Patch-value">
<td><code>value</code></td>
<td><code><a href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#struct">Struct</a></code></td>
<td>
<p>The JSON config of the object being patched. This will be merged using
proto merge semantics with the existing proto in the path.</p>

</td>
<td>
No
</td>
</tr>
<tr id="EnvoyFilter-Patch-filter_class">
<td><code>filterClass</code></td>
<td><code><a href="#EnvoyFilter-Patch-FilterClass">FilterClass</a></code></td>
<td>
<p>Determines the filter insertion order.</p>

</td>
<td>
No
</td>
</tr>
</tbody>
</table>
</section>
<h2 id="EnvoyFilter-EnvoyConfigObjectMatch">EnvoyFilter.EnvoyConfigObjectMatch</h2>
<section>
<p>One or more match conditions to be met before a patch is applied
to the generated configuration for a given proxy.</p>

<table class="message-fields">
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr id="EnvoyFilter-EnvoyConfigObjectMatch-context">
<td><code>context</code></td>
<td><code><a href="#EnvoyFilter-PatchContext">PatchContext</a></code></td>
<td>
<p>The specific config generation context to match on. Istio Pilot
generates envoy configuration in the context of a gateway,
inbound traffic to sidecar and outbound traffic from sidecar.</p>

</td>
<td>
No
</td>
</tr>
<tr id="EnvoyFilter-EnvoyConfigObjectMatch-proxy">
<td><code>proxy</code></td>
<td><code><a href="#EnvoyFilter-ProxyMatch">ProxyMatch</a></code></td>
<td>
<p>Match on properties associated with a proxy.</p>

</td>
<td>
No
</td>
</tr>
<tr id="EnvoyFilter-EnvoyConfigObjectMatch-listener" class="oneof oneof-start">
<td><code>listener</code></td>
<td><code><a href="#EnvoyFilter-ListenerMatch">ListenerMatch (oneof)</a></code></td>
<td>
<p>Match on envoy listener attributes.</p>

</td>
<td>
No
</td>
</tr>
<tr id="EnvoyFilter-EnvoyConfigObjectMatch-route_configuration" class="oneof">
<td><code>routeConfiguration</code></td>
<td><code><a href="#EnvoyFilter-RouteConfigurationMatch">RouteConfigurationMatch (oneof)</a></code></td>
<td>
<p>Match on envoy HTTP route configuration attributes.</p>

</td>
<td>
No
</td>
</tr>
<tr id="EnvoyFilter-EnvoyConfigObjectMatch-cluster" class="oneof">
<td><code>cluster</code></td>
<td><code><a href="#EnvoyFilter-ClusterMatch">ClusterMatch (oneof)</a></code></td>
<td>
<p>Match on envoy cluster attributes.</p>

</td>
<td>
No
</td>
</tr>
</tbody>
</table>
</section>
<h2 id="EnvoyFilter-EnvoyConfigObjectPatch">EnvoyFilter.EnvoyConfigObjectPatch</h2>
<section>
<p>Changes to be made to various envoy config objects.</p>

<table class="message-fields">
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr id="EnvoyFilter-EnvoyConfigObjectPatch-apply_to">
<td><code>applyTo</code></td>
<td><code><a href="#EnvoyFilter-ApplyTo">ApplyTo</a></code></td>
<td>
<p>Specifies where in the Envoy configuration, the patch should be
applied.  The match is expected to select the appropriate
object based on applyTo.  For example, an applyTo with
<code>HTTP_FILTER</code> is expected to have a match condition on the
listeners, with a network filter selection on
<code>envoy.filters.network.http_connection_manager</code> and a sub filter selection on the
HTTP filter relative to which the insertion should be
performed. Similarly, an applyTo on <code>CLUSTER</code> should have a match
(if provided) on the cluster and not on a listener.</p>

</td>
<td>
No
</td>
</tr>
<tr id="EnvoyFilter-EnvoyConfigObjectPatch-match">
<td><code>match</code></td>
<td><code><a href="#EnvoyFilter-EnvoyConfigObjectMatch">EnvoyConfigObjectMatch</a></code></td>
<td>
<p>Match on listener/route configuration/cluster.</p>

</td>
<td>
No
</td>
</tr>
<tr id="EnvoyFilter-EnvoyConfigObjectPatch-patch">
<td><code>patch</code></td>
<td><code><a href="#EnvoyFilter-Patch">Patch</a></code></td>
<td>
<p>The patch to apply along with the operation.</p>

</td>
<td>
No
</td>
</tr>
</tbody>
</table>
</section>
<h2 id="EnvoyFilter-RouteConfigurationMatch-RouteMatch">EnvoyFilter.RouteConfigurationMatch.RouteMatch</h2>
<section>
<p>Match a specific route inside a virtual host in a route configuration.</p>

<table class="message-fields">
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr id="EnvoyFilter-RouteConfigurationMatch-RouteMatch-name">
<td><code>name</code></td>
<td><code>string</code></td>
<td>
<p>The Route objects generated by default are named as
default.  Route objects generated using a virtual service
will carry the name used in the virtual service&rsquo;s HTTP
routes.</p>

</td>
<td>
No
</td>
</tr>
<tr id="EnvoyFilter-RouteConfigurationMatch-RouteMatch-action">
<td><code>action</code></td>
<td><code><a href="#EnvoyFilter-RouteConfigurationMatch-RouteMatch-Action">Action</a></code></td>
<td>
<p>Match a route with specific action type.</p>

</td>
<td>
No
</td>
</tr>
</tbody>
</table>
</section>
<h2 id="EnvoyFilter-RouteConfigurationMatch-VirtualHostMatch">EnvoyFilter.RouteConfigurationMatch.VirtualHostMatch</h2>
<section>
<p>Match a specific virtual host inside a route configuration.</p>

<table class="message-fields">
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr id="EnvoyFilter-RouteConfigurationMatch-VirtualHostMatch-name">
<td><code>name</code></td>
<td><code>string</code></td>
<td>
<p>The VirtualHosts objects generated by Istio are named as
host:port, where the host typically corresponds to the
VirtualService&rsquo;s host field or the hostname of a service in the
registry.</p>

</td>
<td>
No
</td>
</tr>
<tr id="EnvoyFilter-RouteConfigurationMatch-VirtualHostMatch-route">
<td><code>route</code></td>
<td><code><a href="#EnvoyFilter-RouteConfigurationMatch-RouteMatch">RouteMatch</a></code></td>
<td>
<p>Match a specific route within the virtual host.</p>

</td>
<td>
No
</td>
</tr>
</tbody>
</table>
</section>
<h2 id="EnvoyFilter-ListenerMatch-FilterChainMatch">EnvoyFilter.ListenerMatch.FilterChainMatch</h2>
<section>
<p>For listeners with multiple filter chains (e.g., inbound
listeners on sidecars with permissive mTLS, gateway listeners
with multiple SNI matches), the filter chain match can be used
to select a specific filter chain to patch.</p>

<table class="message-fields">
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr id="EnvoyFilter-ListenerMatch-FilterChainMatch-name">
<td><code>name</code></td>
<td><code>string</code></td>
<td>
<p>The name assigned to the filter chain.</p>

</td>
<td>
No
</td>
</tr>
<tr id="EnvoyFilter-ListenerMatch-FilterChainMatch-sni">
<td><code>sni</code></td>
<td><code>string</code></td>
<td>
<p>The SNI value used by a filter chain&rsquo;s match condition.  This
condition will evaluate to false if the filter chain has no
sni match.</p>

</td>
<td>
No
</td>
</tr>
<tr id="EnvoyFilter-ListenerMatch-FilterChainMatch-transport_protocol">
<td><code>transportProtocol</code></td>
<td><code>string</code></td>
<td>
<p>Applies only to <code>SIDECAR_INBOUND</code> context. If non-empty, a
transport protocol to consider when determining a filter
chain match.  This value will be compared against the
transport protocol of a new connection, when it&rsquo;s detected by
the <code>tls_inspector</code> listener filter.</p>

<p>Accepted values include:</p>

<ul>
<li><code>raw_buffer</code> - default, used when no transport protocol is detected.</li>
<li><code>tls</code> - set when TLS protocol is detected by the TLS inspector.</li>
</ul>

</td>
<td>
No
</td>
</tr>
<tr id="EnvoyFilter-ListenerMatch-FilterChainMatch-application_protocols">
<td><code>applicationProtocols</code></td>
<td><code>string</code></td>
<td>
<p>Applies only to sidecars. If non-empty, a comma separated set
of application protocols to consider when determining a
filter chain match.  This value will be compared against the
application protocols of a new connection, when it&rsquo;s detected
by one of the listener filters such as the <code>http_inspector</code>.</p>

<p>Accepted values include: h2, http/1.1, http/1.0</p>

</td>
<td>
No
</td>
</tr>
<tr id="EnvoyFilter-ListenerMatch-FilterChainMatch-filter">
<td><code>filter</code></td>
<td><code><a href="#EnvoyFilter-ListenerMatch-FilterMatch">FilterMatch</a></code></td>
<td>
<p>The name of a specific filter to apply the patch to. Set this
to <code>envoy.filters.network.http_connection_manager</code> to add a filter or apply a
patch to the HTTP connection manager.</p>

</td>
<td>
No
</td>
</tr>
</tbody>
</table>
</section>
<h2 id="EnvoyFilter-ListenerMatch-FilterMatch">EnvoyFilter.ListenerMatch.FilterMatch</h2>
<section>
<p>Conditions to match a specific filter within a filter chain.</p>

<table class="message-fields">
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr id="EnvoyFilter-ListenerMatch-FilterMatch-name">
<td><code>name</code></td>
<td><code>string</code></td>
<td>
<p>The filter name to match on.
For standard Envoy filters, <a href="https://www.envoyproxy.io/docs/envoy/latest/version_history/v1.14.0#deprecated">canonical filter</a>
names should be used.</p>

</td>
<td>
No
</td>
</tr>
<tr id="EnvoyFilter-ListenerMatch-FilterMatch-sub_filter">
<td><code>subFilter</code></td>
<td><code><a href="#EnvoyFilter-ListenerMatch-SubFilterMatch">SubFilterMatch</a></code></td>
<td>
<p>The next level filter within this filter to match
upon. Typically used for HTTP Connection Manager filters and
Thrift filters.</p>

</td>
<td>
No
</td>
</tr>
</tbody>
</table>
</section>
<h2 id="EnvoyFilter-ListenerMatch-SubFilterMatch">EnvoyFilter.ListenerMatch.SubFilterMatch</h2>
<section>
<p>Conditions to match a specific filter within another
filter. This field is typically useful to match a HTTP filter
inside the <code>envoy.filters.network.http_connection_manager</code> network filter.
This could also be applicable for thrift filters.</p>

<table class="message-fields">
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr id="EnvoyFilter-ListenerMatch-SubFilterMatch-name">
<td><code>name</code></td>
<td><code>string</code></td>
<td>
<p>The filter name to match on.</p>

</td>
<td>
No
</td>
</tr>
</tbody>
</table>
</section>
<h2 id="EnvoyFilter-RouteConfigurationMatch-RouteMatch-Action">EnvoyFilter.RouteConfigurationMatch.RouteMatch.Action</h2>
<section>
<p>Action refers to the route action taken by Envoy when a http route matches.</p>

<table class="enum-values">
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr id="EnvoyFilter-RouteConfigurationMatch-RouteMatch-Action-ANY">
<td><code>ANY</code></td>
<td>
<p>All three route actions</p>

</td>
</tr>
<tr id="EnvoyFilter-RouteConfigurationMatch-RouteMatch-Action-ROUTE">
<td><code>ROUTE</code></td>
<td>
<p>Route traffic to a cluster / weighted clusters.</p>

</td>
</tr>
<tr id="EnvoyFilter-RouteConfigurationMatch-RouteMatch-Action-REDIRECT">
<td><code>REDIRECT</code></td>
<td>
<p>Redirect request.</p>

</td>
</tr>
<tr id="EnvoyFilter-RouteConfigurationMatch-RouteMatch-Action-DIRECT_RESPONSE">
<td><code>DIRECT_RESPONSE</code></td>
<td>
<p>directly respond to a request with specific payload.</p>

</td>
</tr>
</tbody>
</table>
</section>
<h2 id="EnvoyFilter-Patch-Operation">EnvoyFilter.Patch.Operation</h2>
<section>
<p>Operation denotes how the patch should be applied to the selected
configuration.</p>

<table class="enum-values">
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr id="EnvoyFilter-Patch-Operation-INVALID">
<td><code>INVALID</code></td>
<td>
</td>
</tr>
<tr id="EnvoyFilter-Patch-Operation-MERGE">
<td><code>MERGE</code></td>
<td>
<p>Merge the provided config with the generated config using
proto merge semantics. If you are specifying config in its
entirity, use <code>REPLACE</code> instead.</p>

</td>
</tr>
<tr id="EnvoyFilter-Patch-Operation-ADD">
<td><code>ADD</code></td>
<td>
<p>Add the provided config to an existing list (of listeners,
clusters, virtual hosts, network filters, or http
filters). This operation will be ignored when <code>applyTo</code> is set
to <code>ROUTE_CONFIGURATION</code>, or <code>HTTP_ROUTE</code>.</p>

</td>
</tr>
<tr id="EnvoyFilter-Patch-Operation-REMOVE">
<td><code>REMOVE</code></td>
<td>
<p>Remove the selected object from the list (of listeners,
clusters, virtual hosts, network filters, routes, or http
filters). Does not require a value to be specified. This
operation will be ignored when <code>applyTo</code> is set to
<code>ROUTE_CONFIGURATION</code>, or <code>HTTP_ROUTE</code>.</p>

</td>
</tr>
<tr id="EnvoyFilter-Patch-Operation-INSERT_BEFORE">
<td><code>INSERT_BEFORE</code></td>
<td>
<p>Insert operation on an array of named objects. This operation
is typically useful only in the context of filters or routes,
where the order of elements matter. Routes should be ordered
based on most to least specific matching criteria since the
first matching element is selected. For clusters and virtual hosts,
order of the element in the array does not matter. Insert
before the selected filter or sub filter. If no filter is
selected, the specified filter will be inserted at the front
of the list.</p>

</td>
</tr>
<tr id="EnvoyFilter-Patch-Operation-INSERT_AFTER">
<td><code>INSERT_AFTER</code></td>
<td>
<p>Insert operation on an array of named objects. This operation
is typically useful only in the context of filters or routes,
where the order of elements matter. Routes should be ordered
based on most to least specific matching criteria since the
first matching element is selected. For clusters and virtual hosts,
order of the element in the array does not matter. Insert
after the selected filter or sub filter. If no filter is
selected, the specified filter will be inserted at the end
of the list.</p>

</td>
</tr>
<tr id="EnvoyFilter-Patch-Operation-INSERT_FIRST">
<td><code>INSERT_FIRST</code></td>
<td>
<p>Insert operation on an array of named objects. This operation
is typically useful only in the context of filters or routes,
where the order of elements matter. Routes should be ordered
based on most to least specific matching criteria since the
first matching element is selected. For clusters and virtual hosts,
order of the element in the array does not matter. Insert
first in the list based on the presence of selected filter or not.
This is specifically useful when you want your filter first in the
list based on a match condition specified in Match clause.</p>

</td>
</tr>
<tr id="EnvoyFilter-Patch-Operation-REPLACE">
<td><code>REPLACE</code></td>
<td>
<p>Replace contents of a named filter with new contents.
<code>REPLACE</code> operation is only valid for <code>HTTP_FILTER</code> and
<code>NETWORK_FILTER</code>. If the named filter is not found, this operation
has no effect.</p>

</td>
</tr>
</tbody>
</table>
</section>
<h2 id="EnvoyFilter-Patch-FilterClass">EnvoyFilter.Patch.FilterClass</h2>
<section>
<p>FilterClass determines the filter insertion point in the filter chain
relative to the filters implicitly inserted by the control plane.
It is used in conjuction with the <code>ADD</code> operation.
This is the preferred insertion mechanism for adding filters over
the <code>INSERT_*</code> operations since those operations rely on potentially unstable
filter names.
Filter ordering is important if your filter depends on or affects the
functioning of a another filter in the filter chain.
Within a filter class, filters are inserted in the order of processing.</p>

<table class="enum-values">
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr id="EnvoyFilter-Patch-FilterClass-UNSPECIFIED">
<td><code>UNSPECIFIED</code></td>
<td>
<p>Control plane decides where to insert the filter.
Do not specify <code>FilterClass</code> if the filter is independent of others.</p>

</td>
</tr>
<tr id="EnvoyFilter-Patch-FilterClass-AUTHN">
<td><code>AUTHN</code></td>
<td>
<p>Insert filter after Istio authentication filters.</p>

</td>
</tr>
<tr id="EnvoyFilter-Patch-FilterClass-AUTHZ">
<td><code>AUTHZ</code></td>
<td>
<p>Insert filter after Istio authorization filters.</p>

</td>
</tr>
<tr id="EnvoyFilter-Patch-FilterClass-STATS">
<td><code>STATS</code></td>
<td>
<p>Insert filter before Istio stats filters.</p>

</td>
</tr>
</tbody>
</table>
</section>
<h2 id="EnvoyFilter-ApplyTo">EnvoyFilter.ApplyTo</h2>
<section>
<p><code>ApplyTo</code> specifies where in the Envoy configuration, the given patch should be applied.</p>

<table class="enum-values">
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr id="EnvoyFilter-ApplyTo-INVALID">
<td><code>INVALID</code></td>
<td>
</td>
</tr>
<tr id="EnvoyFilter-ApplyTo-LISTENER">
<td><code>LISTENER</code></td>
<td>
<p>Applies the patch to the listener.</p>

</td>
</tr>
<tr id="EnvoyFilter-ApplyTo-FILTER_CHAIN">
<td><code>FILTER_CHAIN</code></td>
<td>
<p>Applies the patch to the filter chain.</p>

</td>
</tr>
<tr id="EnvoyFilter-ApplyTo-NETWORK_FILTER">
<td><code>NETWORK_FILTER</code></td>
<td>
<p>Applies the patch to the network filter chain, to modify an
existing filter or add a new filter.</p>

</td>
</tr>
<tr id="EnvoyFilter-ApplyTo-HTTP_FILTER">
<td><code>HTTP_FILTER</code></td>
<td>
<p>Applies the patch to the HTTP filter chain in the http
connection manager, to modify an existing filter or add a new
filter.</p>

</td>
</tr>
<tr id="EnvoyFilter-ApplyTo-ROUTE_CONFIGURATION">
<td><code>ROUTE_CONFIGURATION</code></td>
<td>
<p>Applies the patch to the Route configuration (rds output)
inside a HTTP connection manager. This does not apply to the
virtual host. Currently, only <code>MERGE</code> operation is allowed on the
route configuration objects.</p>

</td>
</tr>
<tr id="EnvoyFilter-ApplyTo-VIRTUAL_HOST">
<td><code>VIRTUAL_HOST</code></td>
<td>
<p>Applies the patch to a virtual host inside a route configuration.</p>

</td>
</tr>
<tr id="EnvoyFilter-ApplyTo-HTTP_ROUTE">
<td><code>HTTP_ROUTE</code></td>
<td>
<p>Applies the patch to a route object inside the matched virtual
host in a route configuration.</p>

</td>
</tr>
<tr id="EnvoyFilter-ApplyTo-CLUSTER">
<td><code>CLUSTER</code></td>
<td>
<p>Applies the patch to a cluster in a CDS output. Also used to add new clusters.</p>

</td>
</tr>
<tr id="EnvoyFilter-ApplyTo-EXTENSION_CONFIG">
<td><code>EXTENSION_CONFIG</code></td>
<td>
<p>Applies the patch to or adds an extension config in ECDS output. Note that ECDS
is only supported by HTTP filters.</p>

</td>
</tr>
</tbody>
</table>
</section>
<h2 id="EnvoyFilter-PatchContext">EnvoyFilter.PatchContext</h2>
<section>
<p>PatchContext selects a class of configurations based on the
traffic flow direction and workload type.</p>

<table class="enum-values">
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr id="EnvoyFilter-PatchContext-ANY">
<td><code>ANY</code></td>
<td>
<p>All listeners/routes/clusters in both sidecars and gateways.</p>

</td>
</tr>
<tr id="EnvoyFilter-PatchContext-SIDECAR_INBOUND">
<td><code>SIDECAR_INBOUND</code></td>
<td>
<p>Inbound listener/route/cluster in sidecar.</p>

</td>
</tr>
<tr id="EnvoyFilter-PatchContext-SIDECAR_OUTBOUND">
<td><code>SIDECAR_OUTBOUND</code></td>
<td>
<p>Outbound listener/route/cluster in sidecar.</p>

</td>
</tr>
<tr id="EnvoyFilter-PatchContext-GATEWAY">
<td><code>GATEWAY</code></td>
<td>
<p>Gateway listener/route/cluster.</p>

</td>
</tr>
</tbody>
</table>
</section>
